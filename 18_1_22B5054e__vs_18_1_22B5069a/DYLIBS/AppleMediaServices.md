## AppleMediaServices

> `/System/Library/PrivateFrameworks/AppleMediaServices.framework/AppleMediaServices`

```diff

-8.1.12.0.0
-  __TEXT.__text: 0x6e28dc
-  __TEXT.__auth_stubs: 0x41e0
-  __TEXT.__objc_methlist: 0x1d558
-  __TEXT.__cstring: 0x25d64
-  __TEXT.__const: 0x56594
-  __TEXT.__swift5_typeref: 0x32bb
-  __TEXT.__swift5_reflstr: 0x1974
+8.1.20.0.0
+  __TEXT.__text: 0x6ece20
+  __TEXT.__auth_stubs: 0x42f0
+  __TEXT.__objc_methlist: 0x1d7d0
+  __TEXT.__cstring: 0x266bd
+  __TEXT.__const: 0x56674
+  __TEXT.__swift5_typeref: 0x3313
+  __TEXT.__swift5_reflstr: 0x19b4
   __TEXT.__swift5_assocty: 0x7e0
-  __TEXT.__constg_swiftt: 0x2364
+  __TEXT.__constg_swiftt: 0x2470
   __TEXT.__swift5_builtin: 0x1e0
-  __TEXT.__swift5_fieldmd: 0x1c8c
+  __TEXT.__swift5_fieldmd: 0x1d10
   __TEXT.__swift5_proto: 0x518
-  __TEXT.__swift5_types: 0x260
-  __TEXT.__swift5_capture: 0x1820
+  __TEXT.__swift5_types: 0x274
+  __TEXT.__swift5_capture: 0x1930
   __TEXT.__swift5_mpenum: 0x48
   __TEXT.__swift5_protos: 0x6c
-  __TEXT.__oslogstring: 0x2c702
-  __TEXT.__gcc_except_tab: 0x16e28
+  __TEXT.__oslogstring: 0x2cb2d
+  __TEXT.__gcc_except_tab: 0x16fd8
   __TEXT.__dlopen_cstrs: 0x8d3
   __TEXT.__ustring: 0x1b2
-  __TEXT.__unwind_info: 0x10940
-  __TEXT.__eh_frame: 0xa664
+  __TEXT.__unwind_info: 0x10a98
+  __TEXT.__eh_frame: 0xa784
   __TEXT.__objc_classname: 0x3945
-  __TEXT.__objc_methname: 0x3df2b
-  __TEXT.__objc_methtype: 0x6c51
-  __TEXT.__objc_stubs: 0x2b4a0
-  __DATA_CONST.__got: 0x16c8
-  __DATA_CONST.__const: 0xb420
-  __DATA_CONST.__objc_classlist: 0x1158
+  __TEXT.__objc_methname: 0x3e3d6
+  __TEXT.__objc_methtype: 0x6c63
+  __TEXT.__objc_stubs: 0x2b840
+  __DATA_CONST.__got: 0x1710
+  __DATA_CONST.__const: 0xb468
+  __DATA_CONST.__objc_classlist: 0x1170
   __DATA_CONST.__objc_catlist: 0xf0
-  __DATA_CONST.__objc_protolist: 0x340
+  __DATA_CONST.__objc_protolist: 0x348
   __DATA_CONST.__objc_imageinfo: 0x8
-  __DATA_CONST.__objc_selrefs: 0xdab0
-  __DATA_CONST.__objc_protorefs: 0x160
+  __DATA_CONST.__objc_selrefs: 0xdbd0
+  __DATA_CONST.__objc_protorefs: 0x168
   __DATA_CONST.__objc_superrefs: 0xba0
   __DATA_CONST.__objc_arraydata: 0x4f0
-  __AUTH_CONST.__auth_got: 0x2108
-  __AUTH_CONST.__auth_ptr: 0x978
-  __AUTH_CONST.__const: 0x241d0
-  __AUTH_CONST.__cfstring: 0x1fda0
-  __AUTH_CONST.__objc_const: 0x380e0
+  __AUTH_CONST.__auth_got: 0x2190
+  __AUTH_CONST.__auth_ptr: 0x9a8
+  __AUTH_CONST.__const: 0x244d0
+  __AUTH_CONST.__cfstring: 0x20020
+  __AUTH_CONST.__objc_const: 0x38470
   __AUTH_CONST.__objc_intobj: 0xcc0
   __AUTH_CONST.__objc_arrayobj: 0xf0
   __AUTH_CONST.__objc_dictobj: 0x118
   __AUTH_CONST.__objc_doubleobj: 0x10
-  __AUTH.__objc_data: 0x6c08
-  __AUTH.__data: 0xde8
+  __AUTH.__objc_data: 0x6e68
+  __AUTH.__data: 0xe60
   __AUTH.__thread_vars: 0x30
   __AUTH.__thread_bss: 0x5
-  __DATA.__objc_ivar: 0x16dc
-  __DATA.__data: 0x4dc8
+  __DATA.__objc_ivar: 0x16ec
+  __DATA.__data: 0x4ea8
   __DATA.__bss: 0x7a91
   __DATA.__common: 0xaa0
   __DATA_DIRTY.__objc_ivar: 0x63c
   __DATA_DIRTY.__objc_data: 0x52a8
-  __DATA_DIRTY.__data: 0x1988
+  __DATA_DIRTY.__data: 0x19d0
   __DATA_DIRTY.__bss: 0x33f0
   __DATA_DIRTY.__common: 0x88
   - /System/Library/Frameworks/Accounts.framework/Accounts

   - /System/Library/PrivateFrameworks/CollectionsInternal.framework/CollectionsInternal
   - /System/Library/PrivateFrameworks/CoreSymbolication.framework/CoreSymbolication
   - /System/Library/PrivateFrameworks/CrashReporterSupport.framework/CrashReporterSupport
+  - /System/Library/PrivateFrameworks/CryptoKitPrivate.framework/CryptoKitPrivate
   - /System/Library/PrivateFrameworks/DeviceIdentity.framework/DeviceIdentity
   - /System/Library/PrivateFrameworks/FeatureFlags.framework/FeatureFlags
   - /System/Library/PrivateFrameworks/FeatureFlagsSupport.framework/FeatureFlagsSupport

   - /usr/lib/swift/libswiftCore.dylib
   - /usr/lib/swift/libswiftCoreFoundation.dylib
   - /usr/lib/swift/libswiftCoreMIDI.dylib
+  - /usr/lib/swift/libswiftCryptoTokenKit.dylib
   - /usr/lib/swift/libswiftDarwin.dylib
   - /usr/lib/swift/libswiftDispatch.dylib
   - /usr/lib/swift/libswiftMetal.dylib

   - /usr/lib/swift/libswiftsimd.dylib
   - /usr/lib/swift/libswiftsys_time.dylib
   - /usr/lib/swift/libswiftunistd.dylib
-  Functions: 20361
-  Symbols:   18287
-  CStrings:  19465
+  Functions: 20559
+  Symbols:   18422
+  CStrings:  19587
 
Symbols:
+ _AMSBagKeyPreventSendingBlindedData
+ _OBJC_CLASS_$_AMSBlindedData
+ _OBJC_CLASS_$_AMSBlinder
+ _OBJC_CLASS_$_AMSFinalizedBlind
+ _OBJC_METACLASS_$_AMSBlindedData
+ _OBJC_METACLASS_$_AMSBlinder
+ _OBJC_METACLASS_$_AMSFinalizedBlind
+ _SecRandomCopyBytes
+ __swift_FORCE_LOAD_$_swiftCryptoTokenKit
+ _kSecRandomDefault
+ _objc_release_x11
CStrings:
+ "\x1c\x16"
+ " (storeKey: %!@(MISSING), storeUUID: %!@(MISSING), started: %!@(MISSING), resetInterval: %!@(MISSING), modified: %!@(MISSING), lastSync: %!@(MISSING), crossDeviceSync: %!@(MISSING), deleted: %!@(MISSING), account: %!@(MISSING))"
+ " -- certificate: "
+ " for private input: "
+ " | private input: "
+ "%!{(MISSING)public}@ Failed to generate buySignature for blinded element. %!{(MISSING)public}@"
+ "%!{(MISSING)public}@ Unable to Finalize Blinding. Response missing `token-info` dictionary. buySignature: %!@(MISSING)"
+ "%!{(MISSING)public}@: [%!{(MISSING)public}@] Created new ID in db: %!{(MISSING)public}@"
+ "%!{(MISSING)public}@: [%!{(MISSING)public}@] Created new ID store in db: %!{(MISSING)public}@"
+ "%!{(MISSING)public}@: [%!{(MISSING)public}@] Found ID in db: %!{(MISSING)public}@"
+ "%!{(MISSING)public}@: [%!{(MISSING)public}@] Found ID store in db: %!{(MISSING)public}@"
+ "%!{(MISSING)public}@: [%!{(MISSING)public}@] Updated ID value in db: %!{(MISSING)public}@"
+ "%!{(MISSING)public}@: [%!{(MISSING)public}@] Updated expiry for ID in db: %!{(MISSING)public}@"
+ "%!{(MISSING)public}@Finalize Blinding failed to return data. Error: %!{(MISSING)public}@"
+ "%!{(MISSING)public}@Generating buySignature data"
+ "%!{(MISSING)public}@Not generating buySignature data"
+ "%!{(MISSING)public}@Unable to Finalize Blinding. Array is empty."
+ "%!{(MISSING)public}@Unable to Finalize Blinding. Data missing!"
+ "%!{(MISSING)public}@Unable to Finalize Blinding. Response missing `commerceEvent_purchase_priceType`. metrics: %!@(MISSING)"
+ "%!{(MISSING)public}@Unable to Finalize Blinding. Response missing `metrics` dictionary. metrics: %!@(MISSING)"
+ "%!{(MISSING)public}@Unable to Finalize Blinding. Response missing `songId`. buySignature: %!@(MISSING)"
+ ":\x11\x13\x15\x13"
+ "@\"AMSBlindedData\""
+ "@24@0:8^v16"
+ "A device-generated identifier (aka. a KID) of 24 characters in length was detected in App Store clickstream data in the `userId` field, following a CID identifier of 35 charaters in length for the same `clientId` value. It appears that the `userId` has unexpectedly flipped. \nLogKey: %!@(MISSING), \nCurrent userId: %!@(MISSING), \nLast userId: %!@(MISSING), \neventTime: %!@(MISSING)"
+ "AMSAlwaysSendBlindedData"
+ "AMSAppStoreClickStreamClientId"
+ "AMSAppStoreClickStreamUserIdHistory"
+ "AMSBlindedData"
+ "AMSBlinder"
+ "AMSFinalizedBlind"
+ "AppleMediaServices.BlindedData"
+ "AppleMediaServices.FinalizedBlind"
+ "Base64 Encoding failed"
+ "Caching client: "
+ "Calling SKANUTClient.finalize(). "
+ "Certificate String missing: "
+ "Copy Certificate Key step failed"
+ "Create with Data step failed"
+ "Device-generated KID flip-flop detected in App Store clickstream"
+ "Evaluated Element Error"
+ "Evaulated Element String failed to encode: "
+ "Evaulated Element String missing: "
+ "Extracted public key: "
+ "Finalizing blinded data failed."
+ "Finalizing blinded data."
+ "Make external representation step failed"
+ "Making blinded data. Timestamp: "
+ "Missing Server Data"
+ "Proof String failed to encode: "
+ "Proof String missing: "
+ "Public Input Components Error"
+ "Public Input Token failed to encode: "
+ "Public Key String failed to create with string: "
+ "Public Key String failed to encode: "
+ "Public Key String failed to generate certificate copy with string: "
+ "Public Key String failed to make external representation with string: "
+ "Purchase Task Failed"
+ "Purchase requires Apple Pay Classic, but there was not a payment services URL."
+ "Purchase requires Apple Pay Classic, but we don't have an Apple Pay Classic sheet"
+ "Removing cached client for private input "
+ "Returning cached client: "
+ "T@\"AMSBlindedData\",&,N,V_blindedData"
+ "T@\"NSData\",N,R"
+ "TB,N,V_inFreePeriod"
+ "TB,N,V_requiresApplePayClassic"
+ "TB,N,V_sendBlindedData"
+ "Unable to Finalize Data"
+ "Unable to generate Public Key"
+ "_blindedData"
+ "_buySignatureJSONWithFinalizedBlindedItems:"
+ "_finalizeBlindingWithPurchaseInfo:responseDictionary:outError:"
+ "_generateAndAttachBlindedData"
+ "_inFreePeriod"
+ "_recordEngagementEventWithInfo:responseDictionary:finalizedBlindedItems:error:"
+ "_requiresApplePayClassic"
+ "_sendBlindedData"
+ "_shouldSendBlindedData"
+ "_showAppStoreTTRWithEvent:"
+ "addBlindedData:"
+ "alwaysSendBlindedData"
+ "appStoreClickStreamClientId"
+ "appStoreClickStreamUserIdHistory"
+ "blinded-element"
+ "blindedData"
+ "blindedElement"
+ "blindedElementString"
+ "buySignatures"
+ "commerceEvent_purchase_priceType"
+ "finalizeBlindedDataWithPrivateInput:timeStamp:priceType:adamId:serverData:error:"
+ "finalizedBlindWith:privateInput:timestamp:adamId:"
+ "finalizedBlindedData"
+ "finalizedData"
+ "generateRandomPrivateInput"
+ "generateTimestamp"
+ "inFreePeriod"
+ "initWithBlindedElement:privateInput:timestamp:"
+ "initWithFinalizedData:privateInput:timestamp:adamId:"
+ "isInFreePeriod"
+ "makeBlindedDataWithPrivateInputData:"
+ "preventSendingBlindedData"
+ "privateInput"
+ "removeBlindedData"
+ "removeCachedClientForPrivateInput:"
+ "requiresApplePayClassic"
+ "sendBlindedData"
+ "setAlwaysSendBlindedData:"
+ "setAppStoreClickStreamClientId:"
+ "setAppStoreClickStreamUserIdHistory:"
+ "setBlindedData:"
+ "setInFreePeriod:"
+ "setRequiresApplePayClassic:"
+ "setSendBlindedData:"
+ "songId"
+ "token-info"
- "\x1c\x15"
- " (storeKey: %!@(MISSING), storeUUID: %!@(MISSING), started: %!@(MISSING), storeUUID: %!@(MISSING), resetInterval: %!@(MISSING), modified: %!@(MISSING), lastSync: %!@(MISSING), crossDeviceSync: %!@(MISSING), deleted: %!@(MISSING), account: %!@(MISSING))"
- "*\x11\x13\x15\x13"
- "_recordEngagementEventWithInfo:responseDictionary:error:"

```
