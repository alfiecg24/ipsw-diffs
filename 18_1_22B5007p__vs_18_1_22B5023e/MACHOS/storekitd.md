## storekitd

> `/System/Library/Frameworks/StoreKit.framework/Support/storekitd`

```diff

-814.0.52.0.0
-  __TEXT.__text: 0x24a5bc
-  __TEXT.__auth_stubs: 0x35f0
-  __TEXT.__objc_stubs: 0xccc0
-  __TEXT.__objc_methlist: 0x6b8c
-  __TEXT.__const: 0x1c7e0
-  __TEXT.__cstring: 0xe29a
+814.1.2.0.0
+  __TEXT.__text: 0x2b0360
+  __TEXT.__auth_stubs: 0x36c0
+  __TEXT.__objc_stubs: 0xcce0
+  __TEXT.__objc_methlist: 0x6cec
+  __TEXT.__const: 0x1d270
+  __TEXT.__cstring: 0xf07a
   __TEXT.__oslogstring: 0xca6a
-  __TEXT.__objc_classname: 0x10b6
-  __TEXT.__objc_methname: 0x12034
-  __TEXT.__objc_methtype: 0x33a9
+  __TEXT.__objc_classname: 0x10b0
+  __TEXT.__objc_methname: 0x122a5
+  __TEXT.__objc_methtype: 0x3405
   __TEXT.__gcc_except_tab: 0x2444
   __TEXT.__dlopen_cstrs: 0x68
   __TEXT.__swift5_entry: 0x8
-  __TEXT.__constg_swiftt: 0x20c0
-  __TEXT.__swift5_typeref: 0x2421
-  __TEXT.__swift5_reflstr: 0x1261
-  __TEXT.__swift5_fieldmd: 0x2030
-  __TEXT.__swift5_builtin: 0x190
-  __TEXT.__swift5_assocty: 0x348
-  __TEXT.__swift5_proto: 0x6d4
-  __TEXT.__swift5_types: 0x2b8
-  __TEXT.__swift5_capture: 0xbf0
+  __TEXT.__constg_swiftt: 0x23ec
+  __TEXT.__swift5_typeref: 0x26b3
+  __TEXT.__swift5_reflstr: 0x16a1
+  __TEXT.__swift5_fieldmd: 0x23f0
+  __TEXT.__swift5_builtin: 0x1a4
+  __TEXT.__swift5_assocty: 0x450
+  __TEXT.__swift5_proto: 0x718
+  __TEXT.__swift5_types: 0x2e8
+  __TEXT.__swift5_capture: 0xeec
   __TEXT.__swift5_mpenum: 0x18
-  __TEXT.__swift5_protos: 0x18
+  __TEXT.__swift5_protos: 0x1c
   __TEXT.__info_plist: 0x5e7
-  __TEXT.__unwind_info: 0x6358
-  __TEXT.__eh_frame: 0x9360
-  __DATA_CONST.__auth_got: 0x1b08
-  __DATA_CONST.__got: 0xc10
-  __DATA_CONST.__auth_ptr: 0x8d0
-  __DATA_CONST.__const: 0x14f50
-  __DATA_CONST.__cfstring: 0x6740
-  __DATA_CONST.__objc_classlist: 0x530
+  __TEXT.__unwind_info: 0x6ab8
+  __TEXT.__eh_frame: 0xaa48
+  __DATA_CONST.__auth_got: 0x1b70
+  __DATA_CONST.__got: 0xc60
+  __DATA_CONST.__auth_ptr: 0x9e0
+  __DATA_CONST.__const: 0x148d0
+  __DATA_CONST.__cfstring: 0x6760
+  __DATA_CONST.__objc_classlist: 0x550
   __DATA_CONST.__objc_catlist: 0xb8
-  __DATA_CONST.__objc_protolist: 0x2b0
+  __DATA_CONST.__objc_protolist: 0x2b8
   __DATA_CONST.__objc_imageinfo: 0x8
-  __DATA_CONST.__objc_protorefs: 0x118
+  __DATA_CONST.__objc_protorefs: 0x120
   __DATA_CONST.__objc_classrefs: 0x8
   __DATA_CONST.__objc_superrefs: 0x308
   __DATA_CONST.__objc_arraydata: 0x40
   __DATA_CONST.__objc_dictobj: 0x50
   __DATA_CONST.__objc_intobj: 0x210
   __DATA_CONST.__objc_arrayobj: 0x30
-  __DATA.__objc_const: 0x1aae8
-  __DATA.__objc_selrefs: 0x4600
-  __DATA.__objc_ivar: 0x6dc
-  __DATA.__objc_data: 0x42e0
-  __DATA.__data: 0x5c80
-  __DATA.__bss: 0xe7d0
-  __DATA.__common: 0xd80
+  __DATA.__objc_const: 0x1b770
+  __DATA.__objc_selrefs: 0x46b0
+  __DATA.__objc_ivar: 0x6e4
+  __DATA.__objc_data: 0x4528
+  __DATA.__data: 0x6368
+  __DATA.__bss: 0xef50
+  __DATA.__common: 0xdc0
   - /System/Library/Frameworks/Accounts.framework/Accounts
   - /System/Library/Frameworks/CFNetwork.framework/CFNetwork
   - /System/Library/Frameworks/CoreFoundation.framework/CoreFoundation

   - /usr/lib/swift/libswiftQuartzCore.dylib
   - /usr/lib/swift/libswiftUniformTypeIdentifiers.dylib
   - /usr/lib/swift/libswiftXPC.dylib
+  - /usr/lib/swift/libswift_Builtin_float.dylib
   - /usr/lib/swift/libswift_Concurrency.dylib
   - /usr/lib/swift/libswift_StringProcessing.dylib
+  - /usr/lib/swift/libswift_errno.dylib
+  - /usr/lib/swift/libswift_math.dylib
+  - /usr/lib/swift/libswift_signal.dylib
+  - /usr/lib/swift/libswift_stdio.dylib
+  - /usr/lib/swift/libswift_time.dylib
   - /usr/lib/swift/libswiftos.dylib
   - /usr/lib/swift/libswiftsimd.dylib
-  Functions: 8776
-  Symbols:   1452
-  CStrings:  6272
+  - /usr/lib/swift/libswiftsys_time.dylib
+  - /usr/lib/swift/libswiftunistd.dylib
+  Functions: 9478
+  Symbols:   1481
+  CStrings:  6375
 
Symbols:
+ _$s10Foundation13URLComponentsV6schemeSSSgvs
+ _$s10Foundation18_ErrorCodeProtocolPAAE2teoiySbx_s0B0_ptFZ
+ _$s10Foundation21_BridgedStoredNSErrorPAAE4code4CodeQzvg
+ _$s10Foundation4DateV21timeIntervalSince1970ACSd_tcfC
+ _$s10Foundation4DateV21timeIntervalSince1970Sdvg
+ _$s10Foundation4DateV9formattedSSyF
+ _$sSa034_makeUniqueAndReserveCapacityIfNotB0yyFyXl_Ts5
+ _$sSa12_endMutationyyFyXl_Ts5
+ _$sSa16_createNewBuffer14bufferIsUnique15minimumCapacity13growForAppendySb_SiSbtFyXl_Ts5
+ _$sSa37_appendElementAssumeUniqueAndCapacity_03newB0ySi_xntFyXl_Ts5
+ _$sScS10makeStream2of15bufferingPolicyScSyxG6stream_ScS12ContinuationVyx_G12continuationtxm_AG09BufferingE0Oyx__GtFZ
+ _$sScS12ContinuationV5yieldAB11YieldResultOyyt__GyytRszlF
+ _$sScSMa
+ _$ss13withTaskGroup2of9returning9isolation4bodyq_xm_q_mScA_pSgYiq_ScGyxGzYaXEtYas8SendableRzr0_lF
+ _$ss13withTaskGroup2of9returning9isolation4bodyq_xm_q_mScA_pSgYiq_ScGyxGzYaXEtYas8SendableRzr0_lFTu
+ _$ss24_getErrorEmbeddedNSErroryyXlSgxs0B0RzlF
+ _$ss31withCheckedThrowingContinuation9isolation8function_xScA_pSgYi_SSyScCyxs5Error_pGXEtYaKlF
+ _$ss31withCheckedThrowingContinuation9isolation8function_xScA_pSgYi_SSyScCyxs5Error_pGXEtYaKlFTu
+ _$ss6UInt64VSzsMc
+ _OBJC_CLASS_$_AMSEngagement
+ _OBJC_CLASS_$_AMSEngagementMessageEvent
+ _OBJC_CLASS_$_AMSEngagementMessageEventServiceResponse
+ _OBJC_CLASS_$_AMSEngagementPlacementInfo
+ __swift_FORCE_LOAD_$_swift_Builtin_float
+ __swift_FORCE_LOAD_$_swift_errno
+ __swift_FORCE_LOAD_$_swift_math
+ __swift_FORCE_LOAD_$_swift_signal
+ __swift_FORCE_LOAD_$_swift_stdio
+ __swift_FORCE_LOAD_$_swift_time
+ __swift_FORCE_LOAD_$_swiftsys_time
+ __swift_FORCE_LOAD_$_swiftunistd
+ _swift_allocateGenericValueMetadata
+ _swift_checkMetadataState
+ _swift_deletedAsyncMethodErrorTu
- _$sScC12continuation8functionScCyxq_GSccyxq_G_SStcfC
- _$sScG22awaitAllRemainingTasksyyYaF
- _$sScG22awaitAllRemainingTasksyyYaFTu
- _swift_taskGroup_destroy
- _swift_taskGroup_initialize
CStrings:
+ "\n) ON CONFLICT REPLACE);"
+ " DATETIME DEFAULT (timestamp()),\nPRIMARY KEY (\n"
+ " INTEGER NOT NULL,\n"
+ " TEXT NOT NULL,\n"
+ " for in-app engagement destination "
+ " is not a valid token type"
+ " was cancelled: "
+ "' for offer code redemption."
+ ", continuing anyway. User will be prompted to authenticate."
+ "11:49:54"
+ "@\"<SBSRemoteAlertHandleObserver>\""
+ "Attempting presentation using engagement"
+ "Aug  3 2024"
+ "Clearing all external purchase tokens before "
+ "Dialog task finished with result: "
+ "DisableNewExternalGatewaySheet"
+ "Engagement presentation failed, falling back on platform-specific style"
+ "Engagement sheet finished with result: "
+ "Error checking URL type for redeem code URL "
+ "External Purchase Custom Link"
+ "Failed to add query items to base URL "
+ "Failed to add query parameters to legacy URL '"
+ "Failed to archive request for in-app engagement destination "
+ "Failed to create external gateway log for Magellan"
+ "Failed to fetch presentation mode: "
+ "Failed to get base URL for in-app engagement destination "
+ "Failed to initialize URL components for in-app engagement destination "
+ "Failed to parse base legacy URL '"
+ "Failed to save token ("
+ "Fetching presentation type for mode: "
+ "Found Xcode simulated error for in-app engagement destination "
+ "Found invalid external purchase token values in the bag: "
+ "Ignoring unexpected flow error due to handling legacy URL"
+ "In-app engagement for "
+ "InAppEngagementService"
+ "Invalid external purchase token entity "
+ "Missing link out type value from request to present the sheet for mode "
+ "Missing token type in request to generete the token for mode "
+ "No ExternalGatewayTokens migration for "
+ "No active account for in-app engagement destination "
+ "No active account to present in-app engagement destination "
+ "No client to present refund request UI"
+ "Presenting engagement for mode "
+ "Presenting engagement-driven dialog task for mode "
+ "Presenting engagement-driven sheet for mode "
+ "Received external purchase token "
+ "Received should continue from engagement daemon"
+ "Recording result to daemon for mode "
+ "Recording to daemon finished for mode "
+ "SKExternalPurchaseCustomLinkRegions"
+ "Saving new token for mode "
+ "Starting external gateway request "
+ "T@\"<SBSRemoteAlertHandleObserver>\",W,N,V_observer"
+ "T@\"NSString\",&,N,V_sceneID"
+ "T@\"NSString\",R,N,V_familyID"
+ "The server didn't return a token"
+ "Unhandled ExternalGatewayMode: "
+ "Unknown result from engagement daemon"
+ "Using cached token for mode "
+ "Using code redeem legacy flow for "
+ "] No billing country to check ExternalPurchaseSheet configuration"
+ "_TtC9storekitd28SubscriptionOfferRemoteAlert"
+ "_TtC9storekitdP33_A0B67E5E835CE5C4351F500DE01F7FFD25ExternalGatewayTokenStore"
+ "_TtC9storekitdP33_A0B67E5E835CE5C4351F500DE01F7FFD26ExternalGatewayTokenEntity"
+ "_TtC9storekitdP33_CC0A652C8FC4D059DA9F2A360195F4AA33SubscriptionOfferRemoteAlertActor"
+ "_familyID"
+ "_sceneID"
+ "alertActor"
+ "disableNewExternalGatewaySheet"
+ "disableNewExternalGatewaySheet"
+ "engagementRequest"
+ "enqueueData:"
+ "enqueueMessageEvent:"
+ "externalCustomLinkSheetURL"
+ "externalCustomLinkSheetURL"
+ "externalGatewayRequestType"
+ "externalLinkOutType"
+ "externalLinkTokenType"
+ "externalPurchaseSupportedTokenTypes"
+ "externalPurchaseSupportedTokenTypes"
+ "externalPurchaseTokenV2"
+ "externalPurchaseTokenV2"
+ "external_gateway_tokens"
+ "familyID"
+ "familyID"
+ "initWithFamilyID:"
+ "initWithFamilyID:sceneID:"
+ "initWithPlacement:context:"
+ "initWithServiceType:placementInfo:"
+ "makeDialogRequest"
+ "manage subscriptions"
+ "manageSubscriptionsEngagementRequest(with:reply:)"
+ "manageSubscriptionsEngagementRequestWithRequest:reply:"
+ "messageActions"
+ "metricsOverlay"
+ "observer"
+ "offer"
+ "placementsMap"
+ "presentCodeRedemptionSheet(withSceneID:reply:)"
+ "presentCodeRedemptionSheetWithSceneID:reply:"
+ "presentManageSubscriptions(with:reply:)"
+ "presentManageSubscriptionsWithRequest:reply:"
+ "presentRefundRequestSheet(forTransactionID:sceneID:reply:)"
+ "presentRefundRequestSheetForTransactionID:sceneID:reply:"
+ "sceneID"
+ "sceneID"
+ "setObserver:"
+ "setSceneID:"
+ "storekit-external-custom-link-sheet-url"
+ "storekit_external_purchase_tokens"
+ "storekitd.SubscriptionOfferRemoteAlert"
+ "stream"
+ "v24@?0@\"AMSEngagementMessageEventResponse\"8@\"NSError\"16"
+ "v24@?0@\"NSNumber\"8@\"NSError\"16"
+ "v32@0:8@\"ManageSubscriptionsRequest\"16@?<v@?@\"NSError\">24"
+ "valueForKey:"
+ "xp_ase_appstore_ue"
- "\x05"
- "12:54:43"
- ": Found simulated failure: "
- "Created external purchase token "
- "Failed to archive engagement request, error: "
- "Failed to get manage subscriptions URL, error: "
- "Jul 12 2024"
- "ManageSubscriptionsService"
- "No active account for managing subscriptions, continuing anyway. User will be prompted to authenticate."
- "T@\"NSString\",R,N,V_familyId"
- "_familyId"
- "initWithFamilyId:"
- "manageSubscriptions(with:reply:)"
- "manageSubscriptionsWithRequest:reply:"

```
